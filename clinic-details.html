<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes da Clínica Veterinária</title>
    <!-- Favicon em vários tamanhos para melhor suporte -->
    <link rel="icon" href="Images/DogList-Logo.png" type="image/png" sizes="32x32">
    <link rel="icon" href="Images/DogList-Logo.png" type="image/png" sizes="96x96">
    <link rel="icon" href="Images/DogList-Logo.png" type="image/png" sizes="192x192">
    <link rel="apple-touch-icon" href="Images/DogList-Logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        body {
            background-color: #FFE4D6;
            min-height: 100vh;
            font-family: 'Segoe UI', Arial, sans-serif;
            color: #333;
        }

        .container {
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: #FFE4D6;
        }

        .header {
            background: linear-gradient(135deg, #FFE4D6, #ffb38a);
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            animation: slideDown 0.5s ease-out;
            margin: 0 10px;
            border-radius: 0 0 20px 20px;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .back-button {
            font-size: 28px;
            text-decoration: none;
            color: #FF7F50;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
            background-color: rgba(255, 228, 214, 0.5);
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }

        .back-button:hover {
            background-color: #FFE4D6;
            transform: translateY(-50%) translateX(-3px);
            box-shadow: 0 2px 8px rgba(255, 127, 80, 0.2);
        }

        .logo {
            display: none;
        }

        .title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            letter-spacing: 0.5px;
            text-align: center;
            margin: 0 auto;
            cursor: pointer;
            transition: color 0.3s ease;
            position: relative;
            display: inline-block;
        }

        .title:hover {
            color: #333;
            text-shadow: 0 0 10px rgba(255, 127, 80, 0.3);
        }

        .title:after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 70px;
            height: 2px;
            background-color: #FF7F50;
            border-radius: 2px;
            transition: width 0.3s ease, background-color 0.3s ease;
        }

        .title:hover:after {
            width: 120px;
            background-color: #FF6347;
        }

        .content {
            padding: 10px;
            flex: 1;
            animation: fadeIn 0.8s ease-out;
            background: transparent;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .clinic-details {
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.9);
            margin: 10px 0;
            border-radius: 20px;
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .clinic-details:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        .clinic-name {
            font-size: 26px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #FF7F50;
        }

        .status-indicator {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 8px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .status-open {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .status-closed {
            background: linear-gradient(135deg, #f44336, #e53935);
            color: white;
        }

        .info-section {
            margin: 12px 0;
            padding: 12px 15px;
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .info-section:hover {
            transform: translateX(3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
        }

        .info-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-title i {
            color: #FF7F50;
            font-size: 20px;
        }

        .info-content {
            color: #666;
            line-height: 1.6;
        }

        .working-hour {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 8px 0;
            border-bottom: 1px dashed rgba(0, 0, 0, 0.1);
        }

        .working-hour:last-child {
            border-bottom: none;
        }

        .day {
            font-weight: 500;
            color: #333;
        }

        .hours {
            color: #666;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }

        .action-button {
            padding: 12px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, #FF7F50, #FF6347);
            color: white;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 127, 80, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .action-button:hover {
            background: linear-gradient(135deg, #ff6b3d, #ff5233);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 127, 80, 0.3);
        }

        .navigation {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 15px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 -2px 15px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px 20px 0 0;
            margin: 0 15px;
        }

        .nav-item {
            color: #666;
            text-decoration: none;
            font-size: 22px;
            transition: all 0.3s ease;
            position: relative;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: rgba(255, 228, 214, 0.5);
        }

        .nav-item:hover {
            color: #FF7F50;
            background-color: rgba(255, 228, 214, 0.8);
            transform: translateY(-5px);
        }

        .nav-item.active {
            color: white;
            background-color: #FF7F50;
            box-shadow: 0 4px 10px rgba(255, 127, 80, 0.3);
        }

        .nav-item.active:after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 5px;
            height: 5px;
            background: #FF7F50;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: translateX(-50%) scale(1); opacity: 1; }
            70% { transform: translateX(-50%) scale(2); opacity: 0; }
            100% { transform: translateX(-50%) scale(1); opacity: 0; }
        }

        @media (max-width: 480px) {
            .header {
                padding: 20px;
                margin: 0 8px;
                gap: 5px;
                min-height: 48px;
            }
            
            .title {
                font-size: 18px;
            }
            
            .back-button {
                font-size: 22px;
                width: 35px;
                height: 35px;
                left: 15px;
            }
        }

        /* Adicionar estilos para o botão de VER CLÍNICAS e o popup */
        .show-clinics-btn {
            background-color: #FF7F50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(255, 127, 80, 0.2);
            transition: all 0.3s ease;
            margin-left: auto;
            font-size: 14px;
        }

        .show-clinics-btn:hover {
            background-color: #ff6b3d;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 127, 80, 0.3);
        }

        .clinics-popup {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }

        .clinics-popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .clinics-popup-header h3 {
            margin: 0;
            color: #333;
            font-size: 18px;
        }

        .clinics-popup-content {
            width: 90%;
            max-width: 500px;
            background-color: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .clinics-list {
            padding: 0;
            overflow-y: auto;
            max-height: 70vh;
        }

        .close-btn {
            background: none;
            border: none;
            color: #FF7F50;
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
            transition: all 0.2s ease;
        }

        .close-btn:hover {
            color: #ff6b3d;
            transform: scale(1.1);
        }

        .clinic-item {
            padding: 15px 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }

        .clinic-item:hover {
            background-color: #f9f9f9;
        }

        .clinic-item-name {
            font-weight: 500;
            color: #333;
        }

        .clinic-item-status {
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
        }

        .clinic-popup {
            padding: 5px 15px 15px 15px; /* Reduced top padding */
            min-width: 280px;
            max-width: 320px;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        .popup-title {
            font-size: 16px;
            font-weight: 600;
            margin-top: 0; /* Remove top margin */
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        @media (max-width: 768px) {
            .clinic-details {
                padding: 15px;
            }
            
            .clinic-name {
                font-size: 22px;
            }
            
            .info-section {
                padding: 10px;
            }
            
            .header {
                padding: 20px;
                margin: 0 10px 15px 10px;
            }
            
            .title {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="home.html" class="back-button">←</a>
            <span class="title">Detalhes da Clínica</span>
            <button id="showClinicsBtn" class="show-clinics-btn">VER CLÍNICAS</button>
        </div>

        <div class="content" id="content">
            <!-- O conteúdo será carregado dinamicamente aqui -->
        </div>

        <div id="clinicsList" class="clinics-popup" style="display: none;">
            <div class="clinics-popup-content">
                <div class="clinics-popup-header">
                    <h3>Clínicas Veterinárias Próximas</h3>
                    <button id="closeListBtn" class="close-btn"><i class="fas fa-times"></i></button>
                </div>
                <div class="clinics-list">
                    <!-- Lista de clínicas será carregada aqui -->
                </div>
            </div>
        </div>

        <div id="loadingIndicator" class="loading-indicator">
            <div class="spinner"></div>
            <p class="loading-text">Carregando detalhes da clínica...</p>
        </div>
    </div>

    <script>
        // Verificar se está logado
        if (!localStorage.getItem('loggedIn')) {
            window.location.href = 'index.html';
        }

        // Parâmetros da URL
        const urlParams = new URLSearchParams(window.location.search);
        const placeId = urlParams.get('id');
        const placeName = urlParams.get('name');
        
        if (placeName) {
            document.title = placeName + ' - Detalhes';
        }

        // Função para carregar detalhes da clínica
        window.onload = function() {
            if (!placeId) {
                showError('ID da clínica não encontrado', 'Não foi possível carregar os detalhes desta clínica. Por favor, volte e tente novamente.');
                return;
            }
            
            // Verificar parâmetro adicional para indicar que é a clínica mais próxima
            const isNearest = urlParams.get('nearest') === 'true';
            
            loadClinicDetails(isNearest);
            
            // Adicionar a data atual correta no console
            const now = new Date();
            const weekDays = ['domingo', 'segunda-feira', 'terça-feira', 'quarta-feira', 'quinta-feira', 'sexta-feira', 'sábado'];
            const currentDay = weekDays[now.getDay()];
            console.log("Data atual:", now);
            console.log("Dia da semana:", currentDay, "- número do dia:", now.getDay());
        };

        function loadClinicDetails(isNearest = false) {
            // Temporariamente mostrar o indicador de carregamento
            document.getElementById('loadingIndicator').style.display = 'flex';
            
            // Tentar carregar os dados da API do Google Places
            if (typeof google !== 'undefined' && google.maps && google.maps.places) {
                loadRealClinicDetails(isNearest);
            } else {
                // Fallback para dados mock se a API não estiver disponível
                setTimeout(() => {
                    document.getElementById('loadingIndicator').style.display = 'none';
                    displayMockClinicDetails(isNearest);
                }, 1500);
            }
        }
        
        function loadRealClinicDetails(isNearest = false) {
            console.log("Carregando detalhes da clínica do Google Places API");
                const service = new google.maps.places.PlacesService(document.createElement('div'));
                
            service.getDetails(
                {
                    placeId: placeId,
                    fields: [
                        'name', 
                        'formatted_address', 
                        'formatted_phone_number', 
                        'opening_hours', 
                        'website', 
                        'rating', 
                        'reviews',
                        'geometry'
                    ]
                },
                (place, status) => {
                    // Esconder o indicador de carregamento
                    document.getElementById('loadingIndicator').style.display = 'none';
                    
                    if (status === google.maps.places.PlacesServiceStatus.OK && place) {
                        console.log("Detalhes da clínica obtidos com sucesso:", place);
                        displayClinicDetails(place, isNearest);
                    } else {
                        console.error('Erro ao buscar detalhes da clínica:', status);
                        displayMockClinicDetails(isNearest); // Fallback para dados mock
                    }
                }
            );
        }

        function displayMockClinicDetails(isNearest = false) {
            console.log("Usando dados mock para a clínica");
            
            // Obter a hora atual para determinar se está aberto
            const now = new Date();
            const hour = now.getHours();
            const minute = now.getMinutes();
            const day = now.getDay(); // 0 = domingo, 6 = sábado
            
            // Criar array correto de dias da semana
            const weekDays = ['domingo', 'segunda-feira', 'terça-feira', 'quarta-feira', 'quinta-feira', 'sexta-feira', 'sábado'];
            const currentDay = weekDays[day];
            console.log("Dia atual (mock):", currentDay, "- número do dia:", day);
            
            // Gerar aleatoriamente se a clínica trabalha 24 horas (para demonstração)
            const is24Hours = Math.random() > 0.7;  // 30% de chance de ser 24 horas
            
            // Definir horários baseados na clínica ser 24 horas ou não
            const weekday_text = is24Hours ? [
                'Segunda-feira: 24 horas',
                'Terça-feira: 24 horas',
                'Quarta-feira: 24 horas',
                'Quinta-feira: 24 horas',
                'Sexta-feira: 24 horas',
                'Sábado: 24 horas',
                'Domingo: 24 horas'
            ] : [
                'Segunda-feira: 8:00 - 18:00',
                'Terça-feira: 8:00 - 18:00',
                'Quarta-feira: 8:00 - 18:00',
                'Quinta-feira: 8:00 - 18:00',
                'Sexta-feira: 8:00 - 18:00',
                'Sábado: 9:00 - 14:00',
                'Domingo: Fechado'
            ];
            
            // Determinar se está aberto (se for a clínica mais próxima, sempre estará aberta)
            let isOpen = isNearest ? true : (is24Hours ? true : (() => {
                // Determinar se a clínica não-24h estaria aberta agora
                if (day === 0) return false; // Domingo fechado
                if (day === 6) return hour >= 9 && hour < 14; // Sábado 9h-14h
                return hour >= 8 && hour < 18; // Dias de semana 8h-18h
            })());
            
            // Dados mock para exibir na interface
            const mockClinic = {
                name: placeName || 'Clínica Veterinária',
                address: 'Av. Paulista, 1000 - Bela Vista, São Paulo - SP, 01310-100',
                phone: '(11) 3456-7890',
                isOpen: isOpen,
                rating: 4.5,
                weekday_text: weekday_text,
                website: 'https://www.clinicaveterinaria.com.br',
                location: {
                    lat: -23.5558,  // Coordenadas fictícias da Av. Paulista
                    lng: -46.6624
                }
            };
            
            // Criar conteúdo HTML
            const html = `
                <div class="clinic-details">
                    <h2 class="clinic-name">${mockClinic.name}</h2>
                    <div class="status-indicator ${mockClinic.isOpen ? 'status-open' : 'status-closed'}">
                        <i class="fas fa-${mockClinic.isOpen ? 'check-circle' : 'times-circle'}"></i>
                        ${mockClinic.isOpen ? 'Aberto agora' : 'Fechado'}
                    </div>
                    
                    <div class="info-section">
                        <div class="info-title"><i class="fas fa-map-marker-alt"></i> Endereço</div>
                        <div class="info-content">${mockClinic.address}</div>
                    </div>
                    
                    <div class="info-section map-container">
                        <div class="info-title"><i class="fas fa-map"></i> Localização</div>
                        <div id="clinic-map" style="width: 100%; height: 300px; border-radius: 10px; overflow: hidden; margin-top: 10px;"></div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-title"><i class="fas fa-phone"></i> Telefone</div>
                        <div class="info-content">${mockClinic.phone}</div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-title"><i class="fas fa-clock"></i> Horário de Funcionamento</div>
                        <div class="info-content">
                            ${mockClinic.weekday_text.map(hour => {
                                const parts = hour.split(':');
                                const dayPart = parts[0];
                                const hoursPart = parts.slice(1).join(':').trim();
                                
                                return `<div class="working-hour">
                                    <span class="day">${dayPart}</span>
                                    <span class="hours">${hoursPart}</span>
                                </div>`;
                            }).join('')}
                        </div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-title"><i class="fas fa-star"></i> Avaliação</div>
                        <div class="info-content">${mockClinic.rating} ⭐</div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-title"><i class="fas fa-globe"></i> Website</div>
                        <div class="info-content">
                            <a href="${mockClinic.website}" target="_blank" style="color: #FF7F50; text-decoration: none;">${mockClinic.website}</a>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <a href="https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(mockClinic.address)}" class="action-button" target="_blank">
                            <i class="fas fa-directions"></i> Como Chegar
                        </a>
                        <a href="tel:${mockClinic.phone}" class="action-button">
                            <i class="fas fa-phone"></i> Ligar
                        </a>
                    </div>
                </div>
            `;
            
            // Atualizar a interface
            document.getElementById('content').innerHTML = html;
            
            // Inicializar o mapa com os dados mock
            initializeClinicMap({
                geometry: {
                    location: new google.maps.LatLng(mockClinic.location.lat, mockClinic.location.lng)
                },
                name: mockClinic.name
            });
        }

        function displayClinicDetails(place, isNearest = false) {
            console.log("Exibindo detalhes da clínica:", place.name);
            
            // Determinar se a clínica está aberta agora
            let isOpen = false;
            let hoursHTML = '<p>Horário não disponível</p>';
            
            try {
                // Se for a clínica mais próxima, forçar como aberta
                if (isNearest) {
                    isOpen = true;
                } else if (place.opening_hours) {
                    // Usar API do Google Places para verificar se está aberto
                    isOpen = place.opening_hours.isOpen();
                    
                    // Obter data e dia corretos
                    const now = new Date();
                    const day = now.getDay(); // 0 = domingo, 6 = sábado
                    const weekDays = ['domingo', 'segunda-feira', 'terça-feira', 'quarta-feira', 'quinta-feira', 'sexta-feira', 'sábado'];
                    const currentDay = weekDays[day];
                    console.log("Dia atual (details):", currentDay, "- número do dia:", day);
                    
                    // Formatar corretamente os horários
                    if (place.opening_hours.weekday_text) {
                        hoursHTML = place.opening_hours.weekday_text.map(hour => {
                            const parts = hour.split(':');
                            const dayPart = parts[0];
                            const hoursPart = parts.slice(1).join(':').trim();
                            
                            // Destacar o dia atual
                            const isCurrentDay = dayPart.toLowerCase() === currentDay.toLowerCase();
                            const dayStyle = isCurrentDay ? 'font-weight: bold; color: #FF7F50;' : '';
                            
                            return `
                                <div class="working-hour">
                                    <span class="day" style="${dayStyle}">${dayPart}</span>
                                    <span class="hours">${hoursPart}</span>
                                </div>
                            `;
                        }).join('');
                    }
                } else {
                    // Verificar se o nome da clínica indica funcionamento 24 horas
                    const nameIndicates24Hours = 
                        place.name.toLowerCase().includes('24h') || 
                        place.name.toLowerCase().includes('24 h') || 
                        place.name.toLowerCase().includes('24 horas') ||
                        place.name.toLowerCase().includes('24hr') ||
                        place.name.toLowerCase().includes('24/7') ||
                        place.name.toLowerCase().includes('plantão') ||
                        place.name.toLowerCase().includes('emergência') ||
                        place.name.toLowerCase().includes('emergency');
                        
                    // Obter data e dia atuais
                    const now = new Date();
                    const day = now.getDay(); // 0 = domingo, 6 = sábado
                    const weekDays = ['domingo', 'segunda-feira', 'terça-feira', 'quarta-feira', 'quinta-feira', 'sexta-feira', 'sábado'];
                    const currentDay = weekDays[day];
                    console.log("Dia atual (else):", currentDay, "- número do dia:", day);
                    
                    if (nameIndicates24Hours) {
                        isOpen = true;
                        // Horários para clínica 24h
                        const standardHours = [
                            'Segunda-feira: 24 horas',
                            'Terça-feira: 24 horas',
                            'Quarta-feira: 24 horas',
                            'Quinta-feira: 24 horas',
                            'Sexta-feira: 24 horas',
                            'Sábado: 24 horas',
                            'Domingo: 24 horas'
                        ];
                        
                        hoursHTML = standardHours.map(hour => {
                            const parts = hour.split(':');
                            const dayPart = parts[0];
                            const hoursPart = parts.slice(1).join(':').trim();
                            
                            // Destacar o dia atual
                            const isCurrentDay = dayPart.toLowerCase() === currentDay.toLowerCase();
                            const dayStyle = isCurrentDay ? 'font-weight: bold; color: #FF7F50;' : '';
                            
                            return `
                                <div class="working-hour">
                                    <span class="day" style="${dayStyle}">${dayPart}</span>
                                    <span class="hours">${hoursPart}</span>
                                </div>
                            `;
                        }).join('');
                    } else {
                        // Verificar se está aberto com base no dia e hora
                        if (day === 0) {
                            isOpen = false; // Domingo fechado
                        } else if (day === 6) {
                            isOpen = now.getHours() >= 9 && now.getHours() < 14; // Sábado 9h-14h
                        } else {
                            isOpen = now.getHours() >= 8 && now.getHours() < 18; // Dias de semana 8h-18h
                        }
                        
                        // Horários padrão
                        const standardHours = [
                            'Segunda-feira: 8:00 - 18:00',
                            'Terça-feira: 8:00 - 18:00',
                            'Quarta-feira: 8:00 - 18:00',
                            'Quinta-feira: 8:00 - 18:00',
                            'Sexta-feira: 8:00 - 18:00',
                            'Sábado: 9:00 - 14:00',
                            'Domingo: Fechado'
                        ];
                        
                        hoursHTML = standardHours.map(hour => {
                            const parts = hour.split(':');
                            const dayPart = parts[0];
                            const hoursPart = parts.slice(1).join(':').trim();
                            
                            // Destacar o dia atual
                            const isCurrentDay = dayPart.toLowerCase() === currentDay.toLowerCase();
                            const dayStyle = isCurrentDay ? 'font-weight: bold; color: #FF7F50;' : '';
                            
                            return `
                                <div class="working-hour">
                                    <span class="day" style="${dayStyle}">${dayPart}</span>
                                    <span class="hours">${hoursPart}</span>
                                </div>
                            `;
                        }).join('');
                    }
                }
            } catch (error) {
                console.error('Erro ao verificar horário de funcionamento:', error);
                
                // Em caso de erro, assumir fechado por segurança (exceto se for a clínica mais próxima)
                isOpen = isNearest ? true : false;
                
                // Fallback para horários padrão em caso de erro
                const standardHours = [
                    'Segunda-feira: 8:00 - 18:00',
                    'Terça-feira: 8:00 - 18:00',
                    'Quarta-feira: 8:00 - 18:00',
                    'Quinta-feira: 8:00 - 18:00',
                    'Sexta-feira: 8:00 - 18:00',
                    'Sábado: 9:00 - 14:00',
                    'Domingo: Fechado'
                ];
                
                hoursHTML = standardHours.map(hour => `
                    <div class="working-hour">
                        <span class="day">${hour.split(':')[0]}</span>
                        <span class="hours">${hour.substring(hour.indexOf(':') + 1).trim()}</span>
                    </div>
                `).join('');
            }
            
            // Seção de avaliações
            let reviewsHTML = '';
            if (place.reviews && place.reviews.length > 0) {
                reviewsHTML = `
                <div class="info-section">
                    <div class="info-title"><i class="fas fa-comment"></i> Avaliações</div>
                    <div class="info-content reviews-container">
                        ${place.reviews.slice(0, 3).map(review => `
                            <div class="review-card">
                                <div class="review-header">
                                    <div class="review-author">${review.author_name}</div>
                                    <div class="review-rating">${'★'.repeat(review.rating)}${'☆'.repeat(5-review.rating)}</div>
                                </div>
                                <div class="review-text">${review.text}</div>
                                <div class="review-time">${new Date(review.time * 1000).toLocaleDateString()}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>`;
            }
            
            // Criar conteúdo HTML
            const html = `
                <div class="clinic-details">
                    <h2 class="clinic-name">${place.name}</h2>
                    <div class="status-indicator ${isOpen ? 'status-open' : 'status-closed'}">
                        <i class="fas fa-${isOpen ? 'check-circle' : 'times-circle'}"></i>
                        ${isOpen ? 'Aberto agora' : 'Fechado'}
                    </div>
                    
                    <div class="info-section">
                        <div class="info-title"><i class="fas fa-map-marker-alt"></i> Endereço</div>
                        <div class="info-content">${place.formatted_address || 'Endereço não disponível'}</div>
                    </div>
                    
                    <div class="info-section map-container">
                        <div class="info-title"><i class="fas fa-map"></i> Localização</div>
                        <div id="clinic-map" style="width: 100%; height: 300px; border-radius: 10px; overflow: hidden; margin-top: 10px;"></div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-title"><i class="fas fa-phone"></i> Telefone</div>
                        <div class="info-content">${place.formatted_phone_number || 'Telefone não disponível'}</div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-title"><i class="fas fa-clock"></i> Horário de Funcionamento</div>
                        <div class="info-content">
                            ${hoursHTML}
                        </div>
                </div>
                    
                    ${place.rating ? `
                <div class="info-section">
                        <div class="info-title"><i class="fas fa-star"></i> Avaliação</div>
                        <div class="info-content">${place.rating} ⭐</div>
                </div>
                    ` : ''}
                    
                    ${place.website ? `
                <div class="info-section">
                        <div class="info-title"><i class="fas fa-globe"></i> Website</div>
                        <div class="info-content">
                            <a href="${place.website}" target="_blank" style="color: #FF7F50; text-decoration: none;">${place.website}</a>
                        </div>
                    </div>
                    ` : ''}
                    
                    ${reviewsHTML}
                    
                    <div class="action-buttons">
                        <a href="https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(place.formatted_address || place.name)}" class="action-button" target="_blank">
                            <i class="fas fa-directions"></i> Como Chegar
                        </a>
                        ${place.formatted_phone_number ? `
                        <a href="tel:${place.formatted_phone_number}" class="action-button">
                            <i class="fas fa-phone"></i> Ligar
                        </a>
                        ` : ''}
                    </div>
                </div>
            `;
            
            // Atualizar a interface
            document.getElementById('content').innerHTML = html;
            
            // Inicializar o mapa se houver coordenadas geográficas
            if (place.geometry && place.geometry.location) {
                initializeClinicMap(place);
            }
            
            // Adicionar estilos para reviews
            const style = document.createElement('style');
            style.textContent = `
                .reviews-container {
                    margin-top: 10px;
                }
                .review-card {
                    background-color: #f9f9f9;
                    border-radius: 10px;
                    padding: 15px;
                    margin-bottom: 15px;
                    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
                    transition: all 0.3s ease;
                }
                .review-card:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
                }
                .review-header {
                    display: flex;
                    justify-content: space-between;
                    margin-bottom: 8px;
                }
                .review-author {
                    font-weight: 600;
                    color: #333;
                }
                .review-rating {
                    color: #FF7F50;
                }
                .review-text {
                    color: #666;
                    margin-bottom: 10px;
                    line-height: 1.5;
                    font-size: 0.95em;
                }
                .review-time {
                    font-size: 0.8em;
                    color: #999;
                    text-align: right;
                }
            `;
            document.head.appendChild(style);
        }

        function showError(title, message) {
            document.getElementById('loadingIndicator').style.display = 'none';
            
            const content = document.getElementById('content');
            content.innerHTML = `
                <div style="text-align: center; padding: 40px; background-color: white; border-radius: 20px; margin: 30px 0; box-shadow: 0 6px 25px rgba(0, 0, 0, 0.1);">
                    <div style="color: #f44336; font-size: 60px; margin-bottom: 20px;">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                    <h2 style="margin-bottom: 15px; font-size: 24px; color: #333;">${title}</h2>
                    <p style="color: #666; margin-bottom: 25px;">${message}</p>
                    <a href="clinics.html" style="display: inline-block; padding: 12px 25px; background: linear-gradient(135deg, #FF7F50, #FF6347); color: white; border-radius: 50px; text-decoration: none; font-weight: 600;">
                        <i class="fas fa-arrow-left"></i> Voltar
                    </a>
                </div>
            `;
        }

        function initializeClinicMap(place) {
            // Verificar se a API do Google Maps está carregada
            if (typeof google === 'undefined' || !google.maps) {
                console.error('Google Maps não está disponível');
                return;
            }
            
            const mapElement = document.getElementById('clinic-map');
            if (!mapElement) {
                console.error('Elemento do mapa não encontrado');
                return;
            }
            
            const location = place.geometry.location;
            
            // Criar o mapa
            const map = new google.maps.Map(mapElement, {
                center: location,
                zoom: 15,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                mapTypeControl: false,
                streetViewControl: false,
                fullscreenControl: true,
                zoomControl: true
            });
            
            // Adicionar marcador da clínica
            const marker = new google.maps.Marker({
                position: location,
                map: map,
                title: place.name,
                animation: google.maps.Animation.DROP,
                icon: {
                    path: google.maps.SymbolPath.CIRCLE,
                    fillColor: '#FF7F50',
                    fillOpacity: 0.8,
                    strokeColor: '#FFFFFF',
                    strokeWeight: 2,
                    scale: 10
                }
            });
            
            // Adicionar InfoWindow ao clicar no marcador
            const infoWindow = new google.maps.InfoWindow({
                content: `<div style="text-align: center; padding: 10px;"><strong>${place.name}</strong></div>`
            });
            
            marker.addListener('click', () => {
                infoWindow.open(map, marker);
            });
        }

        // Função para verificar o status de abertura da clínica
        function checkOpeningStatus(place, isNearest) {
            // Verificar se o nome da clínica indica funcionamento 24 horas
            const nameIndicates24Hours = 
                place.name.toLowerCase().includes('24h') || 
                place.name.toLowerCase().includes('24 h') || 
                place.name.toLowerCase().includes('24 horas') ||
                place.name.toLowerCase().includes('24hr') ||
                place.name.toLowerCase().includes('24/7') ||
                place.name.toLowerCase().includes('plantão') ||
                place.name.toLowerCase().includes('emergência') ||
                place.name.toLowerCase().includes('emergency');
            
            // Se o nome indicar 24 horas, a clínica está aberta
            if (nameIndicates24Hours) {
                console.log("Clínica 24h detectada pelo nome:", place.name);
                return true;
            }
            
            // Verificar se temos dados de horário de funcionamento da API
            if (place.opening_hours) {
                try {
                    // Obter o status diretamente da API
                    let isOpen = place.opening_hours.isOpen();
                    
                    // Mesmo se a API disser que está fechada, verificar se os horários indicam 24 horas
                    if (!isOpen && place.opening_hours.weekday_text) {
                        const has24HourDay = place.opening_hours.weekday_text.some(day => {
                            const lowerDay = day.toLowerCase();
                            return lowerDay.includes('24h') || 
                                lowerDay.includes('24 h') || 
                                lowerDay.includes('24 horas') || 
                                lowerDay.includes('24hrs') ||
                                lowerDay.includes('24/7') ||
                                (lowerDay.includes('00:00') && lowerDay.includes('23:59'));
                        });
                        
                        if (has24HourDay) {
                            console.log("Clínica 24h detectada pelos horários:", place.name);
                            return true;
                        }
                    }
                    
                    return isOpen;
                } catch (error) {
                    console.error('Erro ao verificar status de abertura:', error);
                    // Em caso de erro, retornar true apenas se for a clínica mais próxima
                    return isNearest;
                }
            } else {
                // Sem dados de horário da API, usar lógica padrão baseada no dia e hora atual
                console.log("Sem dados de horário para", place.name);
                
                // Se for a clínica mais próxima, mostrar como aberta
                if (isNearest) {
                    console.log("Mostrando a clínica mais próxima como aberta:", place.name);
                    return true;
                }
                
                // Usar lógica padrão de horário comercial
                const now = new Date();
                const day = now.getDay(); // 0 = domingo, 6 = sábado
                const currentHour = now.getHours();
                
                if (day === 0) {
                    return false; // Domingo fechado
                } else if (day === 6) {
                    return currentHour >= 9 && currentHour < 14; // Sábado 9h-14h
                } else {
                    return currentHour >= 8 && currentHour < 18; // Dias de semana 8h-18h
                }
            }
        }

        // Inicializar botão para mostrar clínicas
        document.addEventListener('DOMContentLoaded', function() {
            // Configurar os eventos do botão VER CLÍNICAS
            const showClinicsBtn = document.getElementById('showClinicsBtn');
            const closeListBtn = document.getElementById('closeListBtn');
            const clinicsList = document.getElementById('clinicsList');
            
            if (showClinicsBtn && closeListBtn && clinicsList) {
                showClinicsBtn.addEventListener('click', function() {
                    loadNearbyClinics();
                    clinicsList.style.display = 'flex';
                });
                
                closeListBtn.addEventListener('click', function() {
                    clinicsList.style.display = 'none';
                });
                
                clinicsList.addEventListener('click', function(e) {
                    if (e.target === clinicsList) {
                        clinicsList.style.display = 'none';
                    }
                });
            }
        });
        
        // Função para carregar clínicas próximas
        function loadNearbyClinics() {
            const clinicsList = document.querySelector('.clinics-list');
            
            // Mostrar indicador de carregamento
            clinicsList.innerHTML = '<div style="padding: 20px; text-align: center;"><div class="spinner"></div><p style="margin-top: 10px;">Carregando clínicas próximas...</p></div>';
            
            // Simular carregamento (em produção, usar dados reais)
            setTimeout(() => {
                const clinics = [
                    { name: 'Clínica Veterinária PetCare', isOpen: true },
                    { name: 'Hospital Veterinário 24h', isOpen: true },
                    { name: 'Centro Médico Animal', isOpen: false },
                    { name: 'Clínica Veterinária Amor Pet', isOpen: true },
                    { name: 'PetVet Especialidades', isOpen: false }
                ];
                
                let html = '';
                
                clinics.forEach(clinic => {
                    html += `
                        <div class="clinic-item">
                            <div class="clinic-item-name">${clinic.name}</div>
                        </div>
                    `;
                });
                
                clinicsList.innerHTML = html;
            }, 1500);
        }
    </script>

    <!-- Adicione o script do Google Maps para o mapa -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDYiAXh7HwQgCEudiSzPR3bUuYQ1mnS3b4&libraries=places,geometry" async defer></script>
</body>
</html>